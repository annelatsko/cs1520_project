#The lab from ISL Chapter 4 works extensively with the stock market data Smarket from the ISLR library. 

#Use 10-fold cross-validation to evaluate the performance of logistic
#regression, LDA, QDA, and kNN for k = 1, 2, ..., 10. 

#Use these results to create a plot similar to that on the left-hand side of ISL Figure 5.4 that shows the 10-fold CV error for
#each method. Which method would you prefer?

require(ISLR)
df1 <- data.frame(Smarket)
df2<-df1[complete.cases(df1),]
lm0 <- lm(Today~.,data=df2,na.action=na.omit)

#market.shuf<-df2[sample(nrow(df2)),]
#folds <- cut(seq(1,nrow(market.shuf)),breaks=10,labels=FALSE)
#for(i in 1:10){
#  testIndexes <- which(folds==i,arr.ind=TRUE)
#  testData <- market.shuf[testIndexes, ]
#  trainData <- market.shuf[-testIndexes, ]
#}

#logistic regression
glm.fit <- glm(Direction~Lag1+Lag2+Lag3+Lag4+Lag5+Volume ,data=Smarket ,family=binomial )
glm.probs <- predict(glm.fit,type="response")
glm.pred=rep("Down",1250)
glm.pred[glm.probs>.5]="Up"
set.seed(2)
dat <- data.frame(Smarket)
dat.pred <- rep("Down",1250)
dat.pred[glm.probs]
tc <- trainControl("cv", 10, savePred=TRUE)
(fit <- train(Direction~.,data=Smarket,method="glm",trControl=tc,family=poisson(link = "log")))
